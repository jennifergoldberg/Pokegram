<!DOCTYPE html>
<html lang="en">

<!-- Head Partial -->
<%- include("partials/_head.ejs") %>

<body>
<!-- Nav Partial -->
<%- include("partials/_nav.ejs") %> 

  <div class="card mx-auto" style="width: 30rem;">
    <div class="show-container">
      <div class="card-header">
        <div class="show-header d-flex justify-content-start">
          <img src="<%= post.avatar %>" alt="avatar icon" height="30">
          <p><%= post.username %></p>
        

        <div class="dropdown d-flex justify-content-end">
          <a class="btn btn-secondary dropdown-toggle-split" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
            </svg>
          </a>
        
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <li><a class="dropdown-item" href="/posts/<%= post.id %>/edit">Edit Post</a></li>
            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal" href="#">Delete Post</a></li>
          </ul>
        </div>
        </div>
      </div>
    </div>

    <img src="<%= post.image %>" class="card-img-top" alt="...">
    <div class="card-body" >
      <p class="card-text"><%= post.text %> </p>
    </div>
    <ul class="list-group list-group-flush">
      <% comment.forEach(comments => { %> 
      <li class="list-group-item"><%= comments.text %> </li>
      <% }); %> 
    </ul>
    <div class="card-body">
      <!-- <a href="#" class="card-link">Card link</a>
      <a href="#" class="card-link">Another link</a> -->
    
    <!-- <div class="input-group mb-3"> -->
      <form action="/posts/<%= post.id %>" method="POST">
      <p>Add a comment</p>
      <input 
        type="text" 
        class="form-control" 
        placeholder="username" 
        name="username"
        maxlength="20">
      <input 
        type="text" 
        class="form-control" 
        placeholder="comment" 
        name="text"
        maxlength="144">
      <input 
        type="hidden"
        name="post"
        value= "<%= post.id %> "
      >
      <button class="btn btn-outline-secondary" type="submit" >Post Comment</button>
      </form>
    <!-- </div> -->
    </div>
  </div>
</body>
</html>

<!-- Delete Modal -->

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Delete Post</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this post?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <form 
          action="/posts/<%=post.id %>?_method=DELETE" method="POST">
          <input type="submit" class="btn btn-primary" value="Delete">
        </form>
      </div>
    </div>
  </div>
</div>